var K="http://www.w3.org/1999/xhtml",g=new WeakMap,$=new WeakMap,D=new WeakMap,F={},O=(e,t=globalThis.document.documentElement,f=t.parentNode,m=K,l=!1)=>{var h,u,d,p,y,j,x;if(!f)throw new Error("No parent to render to");if(typeof e=="boolean"){t&&f.removeChild(t);return}let o=typeof e=="string"||typeof e=="number";if(l||!t||o&&t.nodeName!=="#text"||!o&&t.nodeName.toLowerCase()!==e.t.toLowerCase()){let s=t;if(o?t=document.createTextNode(""+e):(e.t==="svg"&&(m="http://www.w3.org/2000/svg"),e.t==="math"&&(m="http://www.w3.org/1998/Math/MathML"),e.t==="feed"&&(m="http://www.w3.org/2005/Atom"),(e.t==="urlset"||e.t==="sitemapindex")&&(m="https://www.sitemaps.org/schemas/sitemap/0.9"),t=(F[e.t]||(F[e.t]=document.createElementNS(m,e.t))).cloneNode(!1)),s?f.replaceChild(t,s):f.appendChild(t),o)return}if(o){t.textContent!=e&&(t.textContent=""+e);return}e.r&&(e.r=()=>!t||!f.contains(t)?!1:(O(e,t,f,m),!0)),e.t==="foreignObject"&&(m=K);let r=e.c.flat(1/0);globalThis!=null&&globalThis.isSkruvSSR||(r=r.filter(s=>{var i;return!((i=s==null?void 0:s.t)!=null&&i.startsWith("skruv"))}));let c={};if(((h=r[0])==null?void 0:h.constructor)===Object&&!((u=r[0])!=null&&u.isSkruvDom)){c=r[0],r=r.slice(1);let s=D.get(t);s||(s={},D.set(t,s));for(let[i,n]of Object.entries(c))if(""+s[i]!=""+n&&i!=="skruvKey"){if(i==="skruvAfterCreate"){setTimeout(()=>n(t),0),s[i]=n;continue}if(i[0]==="o"&&i[1]==="n"){let a=i.slice(2);s[i]?n||t.removeEventListener(a,n):(s[i]&&t.removeEventListener(a,n),t.addEventListener(a,n)),s[i]=n;continue}(i==="checked"||i==="selected"||i==="value"||t.nodeName.includes("-"))&&(t[i]=n),n!==void 0?t.setAttribute(i,""+n):t.removeAttribute(i),s[i]=n}}for(let s of t.getAttributeNames().filter(i=>!Object.keys(c).includes(i)))t.removeAttribute(s);if(!r.length&&t.childNodes.length){if(c.skruvWaitForNotEmpty)return;t.replaceChildren();return}if(t.childNodes.length>r.length)for(let s=t.childNodes.length-1;s>=r.length;s--)t.removeChild(t.childNodes[s]);for(let s=0;s<r.length;s++){let i=!1,n;if((d=r[s])!=null&&d.c)if(n=g.get((p=r[s].c[0])==null?void 0:p.skruvKey),n){if(n!==t.childNodes[s]&&(n===t.childNodes[s+1]?t.removeChild(t.childNodes[s]):t.childNodes[s]&&g.get((x=(j=(y=r[s+1])==null?void 0:y.c)==null?void 0:j[0])==null?void 0:x.skruvKey)===t.childNodes[s]?t.insertBefore(n,t.childNodes[s]):t.childNodes[s]?t.replaceChild(n,t.childNodes[s]):t.appendChild(n)),i=r[s].c[0].skruvKey!==$.get(t.childNodes[s]),!i){let a=g.get(t.childNodes[s]);if(a){let C=!0;for(let w in r[s].c[0].skruvKey)r[s].c[0].skruvKey[w]!==a[w]&&(C=!1);if(C)continue}}}else i=g.has(t.childNodes[s]);O(r[s],t.childNodes[s]||!1,t,m,i)}c.skruvKey&&(g.set(c.skruvKey,t),$.set(t,c.skruvKey),g.set(t,{...c.skruvKey}))},W=new Proxy({},{get:(e,t)=>(...f)=>({isSkruvDom:!0,t,c:f})});var P=()=>{},G=new Promise(e=>{P=e}),v=new Map,U=e=>{let t=0;if(e.length===0)return t.toString();for(let f=0;f<e.length;f++)t=(t<<5)-t+e.charCodeAt(f),t|=0;return t.toString()},L=(e,...t)=>{var x;let f=e.reduce((s,i,n)=>{var a;return s.push(i),s.push(((a=t==null?void 0:t[n])==null?void 0:a.toString())||""),s},[]).join(""),m=/^\[.*?(?:(["'])(?:.|\\\1)*\1.*)*\]/,l=/([([,]|:scope\b)/,o=/^:scope\b/;function r(s,i){let n=s.search(l);if(n===-1)return{selector:`${i} ${s}`,rest:""};if(s[n]===",")return{selector:`${i} ${s.substring(0,n)}`,rest:s.substring(n+1)};let a=!0,C=!1;n=s.search(/\S/);let w=0;t:for(;n<s.length;++n){let R=s[n];switch(R){case"[":{let E=m.exec(s.substring(n));n+=(E?E[0].length:1)-1;continue}case"(":++w;continue;case":":if(a)if(o.test(s.substring(n))){if(w)return null}else continue;else continue;s=s.substring(0,n)+i+s.substring(n+6),n+=i.length,C=!0,--n;continue;case")":w&&--w;continue}if(!w)switch(R){case",":break t;case" ":case">":case"~":case"+":if(!a)continue;a=!1}}return{selector:(C?"":`${i} `)+s.substring(0,n),rest:s.substring(n+1)}}function c(s,i){let n=[];for(;s;){let a=r(s,i);if(a===null)return":not(*)";n.push(a.selector),s=a.rest}return n.join(", ")}function h(s,i){if(s instanceof CSSMediaRule){let n=s.cssRules.length;for(let a=0;a<n;++a)h(s.cssRules[a],i);return}s instanceof CSSStyleRule&&(s.selectorText=c(s.selectorText,i))}let u=U(f),d=`skruv-css-scope-${u}`,p=`.${d}`;if(v.has(u))return d;let y;if(!(globalThis!=null&&globalThis.CSSOM)&&!((x=globalThis.document)!=null&&x.implementation))throw new Error("No css parser available. Either add CSSOM to globalThis or run in browser.");if(globalThis!=null&&globalThis.CSSOM)y=CSSOM.parse(f);else{let s=globalThis.document.implementation.createHTMLDocument(""),i=s.createElementNS("http://www.w3.org/1999/xhtml","style");i.innerText=f,s.body.append(i),y=i.sheet,s.body.removeChild(i)}Array.from((y==null?void 0:y.cssRules)||[]).forEach(s=>h(s,p));let j=Array.from((y==null?void 0:y.cssRules)||[]).map(s=>s.cssText||"").join("");return v.set(u,j),P(),d};async function*z(){for(yield Array.from(v.values()).join("");;)await G,yield Array.from(v.values()).join(""),G=new Promise(e=>{P=e})}var H=e=>{let t=class M{constructor(){this._skruv_promise=new Promise(l=>{this._skruv_resolve=l})}_resolve(){this._skruv_parent&&this._skruv_parent._resolve&&this._skruv_parent._resolve(),this._skruv_resolve(""),this._skruv_promise=new Promise(l=>{this._skruv_resolve=l})}set(l,o,r){return o==="_skruv_parent"?(this._skruv_parent=r,!0):(l[o]!==r&&(l[o]=this.recurse(o,r,l)),!0)}get(l,o,r){return o==="getGenerator"?c=>({key:[c,l],[Symbol.asyncIterator]:()=>{let h=!1;return{next:async()=>(h?await this._skruv_promise:h=!0,{done:!1,value:r[c]})}}}):o==="toJSON"?l.constructor===Object?Object.getOwnPropertyNames(l).reduce((c,h)=>{var u;return c[h]=((u=l[h])==null?void 0:u.toJSON)||l[h],c},{}):l.constructor===Array?l.map(c=>(c==null?void 0:c.toJSON)||c):l:o===Symbol.asyncIterator?()=>{let c=!1;return{next:async()=>(c?await this._skruv_promise:c=!0,{done:!1,value:r})}}:l[o]}deleteProperty(l,o){let r=delete l[o];return this._resolve(),r}recurse(l,o,r){var c;if(o&&o.constructor)if(o.constructor===Object&&((c=r==null?void 0:r[l])==null?void 0:c.constructor)===Object){for(let h of Object.getOwnPropertyNames(o))r[l][h]!==o[h]&&(r[l][h]=o[h]);for(let h of Object.getOwnPropertyNames(r[l]).filter(u=>!Object.getOwnPropertyNames(o).includes(u)))delete r[l][h],this._resolve();return r[l]}else if(o.constructor===Object){let h=new M;o=Object.keys(o).reduce((u,d)=>(u[d]=this.recurse(`${l}.${d}`,o[d]),typeof u[d]=="object"&&u[d]!==null&&(u[d]._skruv_parent=h),u),{}),o=new Proxy(o,h),o._skruv_parent=this,this._resolve()}else if(o.constructor===Array){let h=new M;o=o.map((u,d)=>{let p=this.recurse(`${l}[${d}]`,u);return typeof p=="object"&&p!==null&&(p._skruv_parent=h),p}),o=new Proxy(o,h),o._skruv_parent=this,this._resolve()}else this._resolve();else this._resolve();return o}},f=new Proxy(e.constructor===Array?[]:{},new t("root"));return Object.assign(f,e),f};var b=!0,S=new WeakMap,T=()=>{},V=new Promise(e=>{T=()=>{b=!1,setTimeout(()=>e(""),0)}}),_=new Set,I=(e,t,f,m,l)=>{var o,r;return b&&!(typeof l=="object"&&"c"in l&&((r=(o=l==null?void 0:l.c)==null?void 0:o[0])==null?void 0:r.skruvFinished)===!1)&&(_.delete(e),_.size||T()),S.set(e,l),f[t]=l,m.r?m.r():!0},k=(e,t=null,f=null,m=null,l=!0)=>{if(typeof e=="string"||typeof e=="number"||typeof e=="boolean"||e===null)return e;if(S.has(e))return S.get(e);if(t&&f&&m){if(typeof e=="object"&&Symbol.asyncIterator in e||typeof e=="function"&&e.constructor.name==="AsyncGeneratorFunction")return b&&_.add(e),S.set(e,null),(async()=>{for await(let o of typeof e=="function"?e():e)if(!I(e,t,f,m,k(o,t,f,m,!1)))break})(),null;if(typeof e=="object"&&"then"in e&&typeof e.then=="function"||typeof e=="function"&&e.constructor.name==="AsyncFunction")return b&&_.add(e),S.set(e,null),(async()=>I(e,t,f,m,k(await(typeof e=="function"?e():e),t,f,m,!1)))(),null;if(typeof e=="function"){if(t[0]==="o"&&t[1]==="n"||t==="r"&&(f==null?void 0:f.isSkruvDom)===!0||t==="skruvAfterCreate")return e;let o=k(e(),t,f,m,!1);return S.set(e,o),o}}if(typeof e=="object"){let o={},r=o;e.isSkruvDom===!0?o.r=()=>((b&&!_.size||!b)&&T(),!0):m!=null&&m.r&&(r=m),Array.isArray(e)&&(o=[]);for(let c in e){let h=k(e[c],c,o,r,!1);(h!==null||e[c]===null)&&(o[c]=h)}return(l&&b&&!_.size||!b)&&T(),o}return e};var{html:q,head:Q,title:X,meta:J,link:Y,body:Z,main:N,h1:tt,form:et,label:st,input:ot,button:it,ol:nt,li:rt,a:lt,style:ft,script:ct,skruvText:ht,skruvComment:mt,skruvHeader:at}=W,A=H({todos:["Write todos"]}),ut=L`:scope{color:#f1f1f1;background:#0f0f0f}body{max-width:40ch;margin:0 auto}form{display:flex;align-items:end}label{flex:1}input{width:100%}a{color:#9b9b9b}`,dt=k(q({lang:"en-US",class:ut},Q(X(A.todos.getGenerator(0)),J({name:"viewport",content:"width=device-width, initial-scale=1"}),ft(z),Y({rel:"icon",href:"/icon.svg",type:"image/svg+xml",sizes:"any"}),J({name:"description",content:"Skruv todo-list"})),Z(N(tt(A.todos.getGenerator(0)),et({onsubmit:e=>{var f;e.preventDefault();let t=(f=new FormData(e.currentTarget).get("todo"))==null?void 0:f.toString();t&&A.todos.unshift(t),e.currentTarget.reset()}},st("What do you need to do?",ot({type:"text",name:"todo"})),it("New!")),async function*(){for await(let e of A)yield nt(e.todos.map((t,f)=>rt(`${t} `,lt({href:"#",onclick:m=>{m.preventDefault(),e.todos.splice(f,1)}},"x"))))}),ht("test"),mt("test"),at({name:"x-test",value:"test"}),!!globalThis.skruvSSRScript&&ct({type:"module"},globalThis.skruvSSRScript)))),B=async()=>{await V,O(dt)};B();var Ct=B;export{Ct as default};
//# sourceMappingURL=index.min.js.map
