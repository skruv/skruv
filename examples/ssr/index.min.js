var W=Symbol.for("skruvDom"),b="data-skruv-key",w=new WeakMap,D=new WeakMap,L=new WeakMap,k={},P=(e,t=globalThis.document.documentElement,f=t.parentNode,m=!1,n=!1)=>{var h,d,p,g,u,T;if(!f)throw new Error("No parent to render to");if(typeof e=="boolean"){t&&f.removeChild(t);return}let o=typeof e=="string"||typeof e=="number";if(n||!t||o&&(t==null?void 0:t.nodeName)!=="#text"||!o&&(t==null?void 0:t.nodeName.toLowerCase())!==e.t.toLowerCase()){let s=t;if(o?t=document.createTextNode(""+e):m||e.t==="svg"?(m=!0,t=(k[e.t]||(k[e.t]=document.createElementNS("http://www.w3.org/2000/svg",e.t))).cloneNode(!1)):t=(k[e.t]||(k[e.t]=document.createElement(e.t))).cloneNode(!1),s?f.replaceChild(t,s):f.appendChild(t),o)return}if(o){t.textContent!=e&&(t.textContent=""+e);return}e._r&&(e._r._r=()=>!t||!f.contains(t)?!1:(P(e,t,f,m),!0));let r=e.c.flat(1/0),l={};if(((h=r[0])==null?void 0:h.constructor)===Object&&((d=r[0])==null?void 0:d.s)!==W){l=r[0],r=r.slice(1);for(let s in l)if(!(s===b||s[0]==="_"))if(s[0]==="o"&&s[1]==="n"){let i=L.get(t);i||(i={},L.set(t,i));let c=s.slice(2);if(!i[s]||""+i[s]!=""+l[s]){if(c==="create"){l[s](t),i[s]=l[s];continue}i[s]&&t.removeEventListener(c,i[s]),t.addEventListener(c,l[s]),i[s]=l[s]}else l[s]||t.removeEventListener(c,i[s])}else l[s]!==t.getAttribute(s)&&((s==="checked"||s==="selected"||s==="value"||typeof l[s]=="object")&&(t[s]=l[s]),l[s]?t.setAttribute(s,""+l[s]):t.removeAttribute(s))}if(!r.length&&t.childNodes.length){if(l["data-skruv-wait-for-not-empty"])return;t.replaceChildren();return}if(t.childNodes.length>r.length)for(let s=r.length;s<t.childNodes.length;s++)t.removeChild(t.childNodes[s]);for(let s=0;s<r.length;s++){let i=!1,c;if(r[s].constructor===Object)if(c=w.get((p=r[s].c[0])==null?void 0:p[b]),c){if(c!==t.childNodes[s]&&(c===t.childNodes[s+1]?t.removeChild(t.childNodes[s]):w.get((T=(u=(g=r[s+1])==null?void 0:g.c)==null?void 0:u[0])==null?void 0:T[b])===t.childNodes[s]?t.insertBefore(c,t.childNodes[s]):t.childNodes[s]?t.replaceChild(c,t.childNodes[s]):t.appendChild(c)),i=r[s].c[0][b]!==D.get(t.childNodes[s]),!i){let a=w.get(t.childNodes[s]);if(a){let y=!0;for(let C in r[s].c[0][b])r[s].c[0][b][C]!==a[C]&&(y=!1);if(y)continue}}}else i=w.has(t.childNodes[s]);P(r[s],t.childNodes[s]||!1,t,m,i)}l[b]&&(w.set(l[b],t),D.set(t,l[b]),w.set(t,{...l[b]}))},v=new Proxy({},{get:(e,t)=>(...f)=>({s:W,t,c:f})});var E=()=>{},z=new Promise(e=>{E=e}),A=new Map,B=e=>{let t=0;if(e.length===0)return t.toString();for(let f=0;f<e.length;f++)t=(t<<5)-t+e.charCodeAt(f),t|=0;return t.toString()},I=(e,...t)=>{var s;let f=e.reduce((i,c,a)=>{var y;return i.push(c),i.push(((y=t==null?void 0:t[a])==null?void 0:y.toString())||""),i},[]).join(""),m=/^\[.*?(?:(["'])(?:.|\\\1)*\1.*)*\]/,n=/([([,]|:scope\b)/,o=/^:scope\b/;function r(i,c){let a=i.search(n);if(a===-1)return{selector:`${c} ${i}`,rest:""};if(i[a]===",")return{selector:`${c} ${i.substring(0,a)}`,rest:i.substring(a+1)};let y=!0,C=!1;a=i.search(/\S/);let O=0;e:for(;a<i.length;++a){let F=i[a];switch(F){case"[":{let G=m.exec(i.substring(a));a+=(G?G[0].length:1)-1;continue}case"(":++O;continue;case":":if(y)if(o.test(i.substring(a))){if(O)return null}else continue;else continue;i=i.substring(0,a)+c+i.substring(a+6),a+=c.length,C=!0,--a;continue;case")":O&&--O;continue}if(!O)switch(F){case",":break e;case" ":case">":case"~":case"+":if(!y)continue;y=!1}}return{selector:(C?"":`${c} `)+i.substring(0,a),rest:i.substring(a+1)}}function l(i,c){let a=[];for(;i;){let y=r(i,c);if(y===null)return":not(*)";a.push(y.selector),i=y.rest}return a.join(", ")}function h(i,c){if(i instanceof CSSMediaRule){let a=i.cssRules.length;for(let y=0;y<a;++y)h(i.cssRules[y],c);return}i instanceof CSSStyleRule&&(i.selectorText=l(i.selectorText,c))}let d=B(f),p=`skruv-css-scope-${d}`,g=`.${p}`;if(A.has(d))return p;let u;if(!(globalThis!=null&&globalThis.CSSOM)&&!((s=globalThis.document)!=null&&s.implementation))throw new Error("No css parser available. Either add CSSOM to globalThis or run in browser.");if(globalThis!=null&&globalThis.CSSOM)u=CSSOM.parse(f);else{let i=globalThis.document.implementation.createHTMLDocument(""),c=i.createElement("style");c.innerText=f,i.body.append(c),u=c.sheet,i.body.removeChild(c)}Array.from((u==null?void 0:u.cssRules)||[]).forEach(i=>h(i,g));let T=Array.from((u==null?void 0:u.cssRules)||[]).map(i=>i.cssText||"").join("");return A.set(d,T),E(),p};async function*V(){for(yield Array.from(A.values()).join("");;)await z,yield Array.from(A.values()).join(""),z=new Promise(e=>{E=e})}var U=(globalThis==null?void 0:globalThis.requestAnimationFrame)||(e=>setTimeout(e,0)),H=e=>{let t=class ${constructor(){this._scheduled=!1,this._skruv_promise=new Promise(n=>{this._skruv_resolve=n})}_resolve(){this._skruv_parent&&this._skruv_parent._resolve&&this._skruv_parent._resolve(),!this._scheduled&&(this._scheduled=!0,U(()=>{this._skruv_resolve(""),this._skruv_promise=new Promise(n=>{this._skruv_resolve=n}),this._scheduled=!1}))}set(n,o,r){return o==="_skruv_parent"?(this._skruv_parent=r,!0):(n[o]!==r&&(n[o]=this.recurse(o,r,n)),!0)}get(n,o,r){return o==="getGenerator"?l=>({key:[l,n],[Symbol.asyncIterator]:()=>{let h=!1;return{next:async()=>(h?await this._skruv_promise:h=!0,{done:!1,value:r[l]})}}}):o==="skruv_resolve"?()=>this._resolve():o==="toJSON"?n.constructor===Object?Object.getOwnPropertyNames(n).reduce((l,h)=>{var d;return l[h]=((d=n[h])==null?void 0:d.toJSON)||n[h],l},{}):n.constructor===Array?n.map(l=>(l==null?void 0:l.toJSON)||l):n:o===Symbol.asyncIterator?()=>{let l=!1;return{next:async()=>(l?await this._skruv_promise:l=!0,{done:!1,value:r})}}:n[o]}deleteProperty(n,o){let r=delete n[o];return this._resolve(),r}recurse(n,o,r){var l;if(o&&o.constructor)if(o.constructor===Object&&((l=r==null?void 0:r[n])==null?void 0:l.constructor)===Object){for(let h of Object.getOwnPropertyNames(o))r[n][h]!==o[h]&&(r[n][h]=o[h]);for(let h of Object.getOwnPropertyNames(r[n]).filter(d=>!Object.getOwnPropertyNames(o).includes(d)))delete r[n][h],this._resolve();return r[n]}else if(o.constructor===Object){let h=new $;o=Object.keys(o).reduce((d,p)=>(d[p]=this.recurse(`${n}.${p}`,o[p]),typeof d[p]=="object"&&d[p]!==null&&(d[p]._skruv_parent=h),d),{}),o=new Proxy(o,h),o._skruv_parent=this,this._resolve()}else if(o.constructor===Array){let h=new $;o=o.map((d,p)=>{let g=this.recurse(`${n}[${p}]`,d);return typeof g=="object"&&g!==null&&(g._skruv_parent=h),g}),o=new Proxy(o,h),o._skruv_parent=this,this._resolve()}else this._resolve();else this._resolve();return o}},f=new Proxy(e.constructor===Array?[]:{},new t("root"));return Object.assign(f,e),f};var _=!0,S=new WeakMap,R=()=>{},K=new Promise(e=>{R=()=>e(!0)}),x=new Set,J=(e,t,f,m,n)=>{var o,r;return _&&!(typeof n=="object"&&"c"in n&&((r=(o=n==null?void 0:n.c)==null?void 0:o[0])==null?void 0:r["data-skruv-finished"])===!1)&&(x.delete(e),x.size||(_=!1,setTimeout(()=>R(),0))),S.set(e,n),f[t]=n,m._r._r()},j=(e,t=null,f=null,m=null,n=!0)=>{if(typeof e=="string"||typeof e=="number"||typeof e=="boolean"||e===null)return e;if(S.has(e))return S.get(e);if(t&&f&&m){if(typeof e=="object"&&Symbol.asyncIterator in e||typeof e=="function"&&e.constructor.name==="AsyncGeneratorFunction")return _&&x.add(e),S.set(e,null),(async()=>{for await(let o of typeof e=="function"?e():e)if(!J(e,t,f,m,j(o,t,f,m,!1)))break})(),null;if(typeof e=="object"&&"then"in e&&typeof e.then=="function"||typeof e=="function"&&e.constructor.name==="AsyncFunction")return _&&x.add(e),S.set(e,null),(async()=>J(e,t,f,m,j(await(typeof e=="function"?e():e),t,f,m,!1)))(),null;if(typeof e=="function"){if(typeof t=="string"&&(t[0]==="o"&&t[1]==="n"||t[0]==="_"))return e;let o=j(e(),t,f,m,!1);return S.set(e,o),o}}if(typeof e=="object"){let o={_r:{_r:()=>((_&&!x.size||!_)&&(_=!1,setTimeout(()=>R(),0)),!0)}},r=o;Array.isArray(e)&&(m==null?void 0:m._r)&&(o=[],r=m);for(let l in e){let h=j(e[l],l,o,r,!1);(h!==null||e[l]===null)&&(o[l]=h)}return(n&&_&&!x.size||!_)&&(_=!1,setTimeout(()=>R(),0)),o}return e};var{html:Q,head:X,title:Y,meta:q,link:Z,body:N,main:ee,h1:te,form:se,label:oe,input:ie,button:ne,ol:re,li:le,a:fe,style:ce,script:he}=v,M=H({todos:["Write todos"]}),ae=I`:scope{color:#f1f1f1;background:#0f0f0f}body{max-width:40ch;margin:0 auto}form{display:flex;align-items:end}label{flex:1}input{width:100%}a{color:#9b9b9b}`,me=j(Q({lang:"en-US",class:ae},X(Y(M.todos.getGenerator(0)),q({name:"viewport",content:"width=device-width, initial-scale=1"}),ce(V),Z({rel:"icon",href:"/icon.svg",type:"image/svg+xml",sizes:"any"}),q({name:"description",content:"Skruv todo-list"})),N(ee(te(M.todos.getGenerator(0)),se({onsubmit:e=>{e.preventDefault(),M.todos.unshift(new FormData(e.target).get("todo"))&&e.target.reset()}},oe("What do you need to do?",ie({type:"text",name:"todo"})),ne("New!")),async function*(){for await(let e of M)yield re(e.todos.map((t,f)=>le(`${t} `,fe({href:"#",onclick:m=>{m.preventDefault(),e.todos.splice(f,1)}},"x"))))}),!!globalThis.skruvSSRScript&&he({type:"module"},globalThis.skruvSSRScript)))),de=async()=>{await K,P(me),await new Promise(e=>setTimeout(e,0))};de();export{de as doRender};
//# sourceMappingURL=index.min.js.map
