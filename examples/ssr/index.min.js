var E="http://www.w3.org/1999/xhtml",B="http://www.w3.org/2000/svg",U="http://www.w3.org/1998/Math/MathML",g=new WeakMap,D=new WeakMap,G=new WeakMap,L={},C=(e,t=globalThis.document.documentElement,f=t.parentNode,h=E,n=!1)=>{var a,m,u,p,y,O,x;if(!f)throw new Error("No parent to render to");if(typeof e=="boolean"){t&&f.removeChild(t);return}let o=typeof e=="string"||typeof e=="number";if(n||!t||o&&t.nodeName!=="#text"||!o&&t.nodeName.toLowerCase()!==e.t.toLowerCase()){let s=t;if(o?t=document.createTextNode(""+e):(e.t==="svg"&&(h=B),e.t==="math"&&(h=U),t=(L[e.t]||(L[e.t]=document.createElementNS(h,e.t))).cloneNode(!1)),s?f.replaceChild(t,s):f.appendChild(t),o)return}if(o){t.textContent!=e&&(t.textContent=""+e);return}e.r&&(e.r=()=>!t||!f.contains(t)?!1:(C(e,t,f,h),!0)),e.t==="foreignObject"&&(h=E);let r=e.c.flat(1/0),c={};if(((a=r[0])==null?void 0:a.constructor)===Object&&!((m=r[0])!=null&&m.isSkruvDom)){c=r[0],r=r.slice(1);let s=G.get(t);s||(s={},G.set(t,s));for(let[l,i]of Object.entries(c))if(""+s[l]!=""+i&&l!=="data-skruv-key"){if(l==="data-skruv-after-create"){setTimeout(()=>i(t),0),s[l]=i;continue}if(l[0]==="o"&&l[1]==="n"){let d=l.slice(2);s[l]?i||t.removeEventListener(d,i):(s[l]&&t.removeEventListener(d,i),t.addEventListener(d,i)),s[l]=i;continue}(l==="checked"||l==="selected"||l==="value"||t.nodeName.includes("-"))&&(t[l]=i),i!==void 0?t.setAttribute(l,""+i):t.removeAttribute(l),s[l]=i}}for(let s of t.getAttributeNames().filter(l=>!Object.keys(c).includes(l)))t.removeAttribute(s);if(!r.length&&t.childNodes.length){if(c["data-skruv-wait-for-not-empty"])return;t.replaceChildren();return}if(t.childNodes.length>r.length)for(let s=t.childNodes.length-1;s>=r.length;s--)t.removeChild(t.childNodes[s]);for(let s=0;s<r.length;s++){let l=!1,i;if((u=r[s])!=null&&u.c)if(i=g.get((p=r[s].c[0])==null?void 0:p["data-skruv-key"]),i){if(i!==t.childNodes[s]&&(i===t.childNodes[s+1]?t.removeChild(t.childNodes[s]):t.childNodes[s]&&g.get((x=(O=(y=r[s+1])==null?void 0:y.c)==null?void 0:O[0])==null?void 0:x["data-skruv-key"])===t.childNodes[s]?t.insertBefore(i,t.childNodes[s]):t.childNodes[s]?t.replaceChild(i,t.childNodes[s]):t.appendChild(i)),l=r[s].c[0]["data-skruv-key"]!==D.get(t.childNodes[s]),!l){let d=g.get(t.childNodes[s]);if(d){let j=!0;for(let b in r[s].c[0]["data-skruv-key"])r[s].c[0]["data-skruv-key"][b]!==d[b]&&(j=!1);if(j)continue}}}else l=g.has(t.childNodes[s]);C(r[s],t.childNodes[s]||!1,t,h,l)}c["data-skruv-key"]&&(g.set(c["data-skruv-key"],t),D.set(t,c["data-skruv-key"]),g.set(t,{...c["data-skruv-key"]}))},F=new Proxy({},{get:(e,t)=>(...f)=>({isSkruvDom:!0,t,c:f})});var A=()=>{},W=new Promise(e=>{A=e}),T=new Map,q=e=>{let t=0;if(e.length===0)return t.toString();for(let f=0;f<e.length;f++)t=(t<<5)-t+e.charCodeAt(f),t|=0;return t.toString()},z=(e,...t)=>{var x;let f=e.reduce((s,l,i)=>{var d;return s.push(l),s.push(((d=t==null?void 0:t[i])==null?void 0:d.toString())||""),s},[]).join(""),h=/^\[.*?(?:(["'])(?:.|\\\1)*\1.*)*\]/,n=/([([,]|:scope\b)/,o=/^:scope\b/;function r(s,l){let i=s.search(n);if(i===-1)return{selector:`${l} ${s}`,rest:""};if(s[i]===",")return{selector:`${l} ${s.substring(0,i)}`,rest:s.substring(i+1)};let d=!0,j=!1;i=s.search(/\S/);let b=0;t:for(;i<s.length;++i){let R=s[i];switch(R){case"[":{let $=h.exec(s.substring(i));i+=($?$[0].length:1)-1;continue}case"(":++b;continue;case":":if(d)if(o.test(s.substring(i))){if(b)return null}else continue;else continue;s=s.substring(0,i)+l+s.substring(i+6),i+=l.length,j=!0,--i;continue;case")":b&&--b;continue}if(!b)switch(R){case",":break t;case" ":case">":case"~":case"+":if(!d)continue;d=!1}}return{selector:(j?"":`${l} `)+s.substring(0,i),rest:s.substring(i+1)}}function c(s,l){let i=[];for(;s;){let d=r(s,l);if(d===null)return":not(*)";i.push(d.selector),s=d.rest}return i.join(", ")}function a(s,l){if(s instanceof CSSMediaRule){let i=s.cssRules.length;for(let d=0;d<i;++d)a(s.cssRules[d],l);return}s instanceof CSSStyleRule&&(s.selectorText=c(s.selectorText,l))}let m=q(f),u=`skruv-css-scope-${m}`,p=`.${u}`;if(T.has(m))return u;let y;if(!(globalThis!=null&&globalThis.CSSOM)&&!((x=globalThis.document)!=null&&x.implementation))throw new Error("No css parser available. Either add CSSOM to globalThis or run in browser.");if(globalThis!=null&&globalThis.CSSOM)y=CSSOM.parse(f);else{let s=globalThis.document.implementation.createHTMLDocument(""),l=s.createElementNS("http://www.w3.org/1999/xhtml","style");l.innerText=f,s.body.append(l),y=l.sheet,s.body.removeChild(l)}Array.from((y==null?void 0:y.cssRules)||[]).forEach(s=>a(s,p));let O=Array.from((y==null?void 0:y.cssRules)||[]).map(s=>s.cssText||"").join("");return T.set(m,O),A(),u};async function*I(){for(yield Array.from(T.values()).join("");;)await W,yield Array.from(T.values()).join(""),W=new Promise(e=>{A=e})}var V=e=>{let t=class M{constructor(){this._scheduled=!1,this._skruv_promise=new Promise(n=>{this._skruv_resolve=n})}_resolve(){this._skruv_parent&&this._skruv_parent._resolve&&this._skruv_parent._resolve(),!this._scheduled&&(this._scheduled=!0,setTimeout(()=>{this._skruv_resolve(""),this._skruv_promise=new Promise(n=>{this._skruv_resolve=n}),this._scheduled=!1},0))}set(n,o,r){return o==="_skruv_parent"?(this._skruv_parent=r,!0):(n[o]!==r&&(n[o]=this.recurse(o,r,n)),!0)}get(n,o,r){return o==="getGenerator"?c=>({key:[c,n],[Symbol.asyncIterator]:()=>{let a=!1;return{next:async()=>(a?await this._skruv_promise:a=!0,{done:!1,value:r[c]})}}}):o==="toJSON"?n.constructor===Object?Object.getOwnPropertyNames(n).reduce((c,a)=>{var m;return c[a]=((m=n[a])==null?void 0:m.toJSON)||n[a],c},{}):n.constructor===Array?n.map(c=>(c==null?void 0:c.toJSON)||c):n:o===Symbol.asyncIterator?()=>{let c=!1;return{next:async()=>(c?await this._skruv_promise:c=!0,{done:!1,value:r})}}:n[o]}deleteProperty(n,o){let r=delete n[o];return this._resolve(),r}recurse(n,o,r){var c;if(o&&o.constructor)if(o.constructor===Object&&((c=r==null?void 0:r[n])==null?void 0:c.constructor)===Object){for(let a of Object.getOwnPropertyNames(o))r[n][a]!==o[a]&&(r[n][a]=o[a]);for(let a of Object.getOwnPropertyNames(r[n]).filter(m=>!Object.getOwnPropertyNames(o).includes(m)))delete r[n][a],this._resolve();return r[n]}else if(o.constructor===Object){let a=new M;o=Object.keys(o).reduce((m,u)=>(m[u]=this.recurse(`${n}.${u}`,o[u]),typeof m[u]=="object"&&m[u]!==null&&(m[u]._skruv_parent=a),m),{}),o=new Proxy(o,a),o._skruv_parent=this,this._resolve()}else if(o.constructor===Array){let a=new M;o=o.map((m,u)=>{let p=this.recurse(`${n}[${u}]`,m);return typeof p=="object"&&p!==null&&(p._skruv_parent=a),p}),o=new Proxy(o,a),o._skruv_parent=this,this._resolve()}else this._resolve();else this._resolve();return o}},f=new Proxy(e.constructor===Array?[]:{},new t("root"));return Object.assign(f,e),f};var w=!0,S=new WeakMap,v=()=>{},J=new Promise(e=>{v=()=>{w=!1,setTimeout(()=>e(""),0)}}),k=new Set,H=(e,t,f,h,n)=>{var o,r;return w&&!(typeof n=="object"&&"c"in n&&((r=(o=n==null?void 0:n.c)==null?void 0:o[0])==null?void 0:r["data-skruv-finished"])===!1)&&(k.delete(e),k.size||v()),S.set(e,n),f[t]=n,h.r?h.r():!0},_=(e,t=null,f=null,h=null,n=!0)=>{if(typeof e=="string"||typeof e=="number"||typeof e=="boolean"||e===null)return e;if(S.has(e))return S.get(e);if(t&&f&&h){if(typeof e=="object"&&Symbol.asyncIterator in e||typeof e=="function"&&e.constructor.name==="AsyncGeneratorFunction")return w&&k.add(e),S.set(e,null),(async()=>{for await(let o of typeof e=="function"?e():e)if(!H(e,t,f,h,_(o,t,f,h,!1)))break})(),null;if(typeof e=="object"&&"then"in e&&typeof e.then=="function"||typeof e=="function"&&e.constructor.name==="AsyncFunction")return w&&k.add(e),S.set(e,null),(async()=>H(e,t,f,h,_(await(typeof e=="function"?e():e),t,f,h,!1)))(),null;if(typeof e=="function"){if(t[0]==="o"&&t[1]==="n"||t==="r"&&(f==null?void 0:f.isSkruvDom)===!0||t==="data-skruv-after-create"||t==="data-skruv-after-remove")return e;let o=_(e(),t,f,h,!1);return S.set(e,o),o}}if(typeof e=="object"){let o={},r=o;e.isSkruvDom===!0?o.r=()=>((w&&!k.size||!w)&&v(),!0):h!=null&&h.r&&(r=h),Array.isArray(e)&&(o=[]);for(let c in e){let a=_(e[c],c,o,r,!1);(a!==null||e[c]===null)&&(o[c]=a)}return(n&&w&&!k.size||!w)&&v(),o}return e};var{html:Q,head:X,title:Y,meta:K,link:Z,body:N,main:tt,h1:et,form:st,label:ot,input:it,button:nt,ol:rt,li:lt,a:ft,style:ct,script:at}=F,P=V({todos:["Write todos"]}),ht=z`:scope{color:#f1f1f1;background:#0f0f0f}body{max-width:40ch;margin:0 auto}form{display:flex;align-items:end}label{flex:1}input{width:100%}a{color:#9b9b9b}`,dt=_(Q({lang:"en-US",class:ht},X(Y(P.todos.getGenerator(0)),K({name:"viewport",content:"width=device-width, initial-scale=1"}),ct(I),Z({rel:"icon",href:"/icon.svg",type:"image/svg+xml",sizes:"any"}),K({name:"description",content:"Skruv todo-list"})),N(tt(et(P.todos.getGenerator(0)),st({onsubmit:e=>{var f;e.preventDefault();let t=(f=new FormData(e.currentTarget).get("todo"))==null?void 0:f.toString();t&&P.todos.unshift(t),e.currentTarget.reset()}},ot("What do you need to do?",it({type:"text",name:"todo"})),nt("New!")),async function*(){for await(let e of P)yield rt(e.todos.map((t,f)=>lt(`${t} `,ft({href:"#",onclick:h=>{h.preventDefault(),e.todos.splice(f,1)}},"x"))))}),!!globalThis.skruvSSRScript&&at({type:"module"},globalThis.skruvSSRScript)))),mt=async()=>{await J,C(dt),await new Promise(e=>setTimeout(e,0))};mt();export{mt as doRender};
//# sourceMappingURL=index.min.js.map
