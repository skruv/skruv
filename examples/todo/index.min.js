var F=Symbol.for("skruvDom"),b="data-skruv-key",x=new WeakMap,I=new WeakMap,V=new WeakMap,P={},E=(e,t=globalThis.document.documentElement,c=t.parentNode,f=!1,i=!1)=>{var a,d,p,w,u,A;if(!c)throw new Error("No parent to render to");if(typeof e=="boolean"){t&&c.removeChild(t);return}let o=typeof e=="string"||typeof e=="number";if(i||!t||o&&(t==null?void 0:t.nodeName)!=="#text"||!o&&(t==null?void 0:t.nodeName.toLowerCase())!==e.t.toLowerCase()){let s=t;if(o?t=document.createTextNode(""+e):f||e.t==="svg"?(f=!0,t=(P[e.t]||(P[e.t]=document.createElementNS("http://www.w3.org/2000/svg",e.t))).cloneNode(!1)):t=(P[e.t]||(P[e.t]=document.createElement(e.t))).cloneNode(!1),s?c.replaceChild(t,s):c.appendChild(t),o)return}if(o){t.textContent!=e&&(t.textContent=""+e);return}e._r&&(e._r._r=()=>!t||!c.contains(t)?!1:(E(e,t,c,f),!0));let l=e.c.flat(1/0),r={};if(((a=l[0])==null?void 0:a.constructor)===Object&&((d=l[0])==null?void 0:d.s)!==F){r=l[0],l=l.slice(1);for(let s in r)if(!(s===b||s[0]==="_"))if(s[0]==="o"&&s[1]==="n"){let n=V.get(t);n||(n={},V.set(t,n));let h=s.slice(2);if(!n[s]||""+n[s]!=""+r[s]){if(h==="create"){r[s](t),n[s]=r[s];continue}n[s]&&t.removeEventListener(h,n[s]),t.addEventListener(h,r[s]),n[s]=r[s]}else r[s]||t.removeEventListener(h,n[s])}else r[s]!==t.getAttribute(s)&&((s==="checked"||s==="selected"||s==="value"||typeof r[s]=="object")&&(t[s]=r[s]),r[s]?t.setAttribute(s,""+r[s]):t.removeAttribute(s))}if(!l.length&&t.childNodes.length){if(r["data-skruv-wait-for-not-empty"])return;t.replaceChildren();return}if(t.childNodes.length>l.length)for(let s=l.length;s<t.childNodes.length;s++)t.removeChild(t.childNodes[s]);for(let s=0;s<l.length;s++){let n=!1,h;if(l[s].constructor===Object)if(h=x.get((p=l[s].c[0])==null?void 0:p[b]),h){if(h!==t.childNodes[s]&&(h===t.childNodes[s+1]?t.removeChild(t.childNodes[s]):t.childNodes[s]&&x.get((A=(u=(w=l[s+1])==null?void 0:w.c)==null?void 0:u[0])==null?void 0:A[b])===t.childNodes[s]?t.insertBefore(h,t.childNodes[s]):t.childNodes[s]?t.replaceChild(h,t.childNodes[s]):t.appendChild(h)),n=l[s].c[0][b]!==I.get(t.childNodes[s]),!n){let m=x.get(t.childNodes[s]);if(m){let y=!0;for(let k in l[s].c[0][b])l[s].c[0][b][k]!==m[k]&&(y=!1);if(y)continue}}}else n=x.has(t.childNodes[s]);E(l[s],t.childNodes[s]||!1,t,f&&e.t!=="foreignObject",n)}r[b]&&(x.set(r[b],t),I.set(t,r[b]),x.set(t,{...r[b]}))},N=new Proxy({},{get:(e,t)=>(...c)=>({s:F,t,c})}),G=(e,...t)=>({s:F,t:e,c:t});var L=()=>{},H=new Promise(e=>{L=e}),M=new Map,Q=e=>{let t=0;if(e.length===0)return t.toString();for(let c=0;c<e.length;c++)t=(t<<5)-t+e.charCodeAt(c),t|=0;return t.toString()},J=(e,...t)=>{var s;let c=e.reduce((n,h,m)=>{var y;return n.push(h),n.push(((y=t==null?void 0:t[m])==null?void 0:y.toString())||""),n},[]).join(""),f=/^\[.*?(?:(["'])(?:.|\\\1)*\1.*)*\]/,i=/([([,]|:scope\b)/,o=/^:scope\b/;function l(n,h){let m=n.search(i);if(m===-1)return{selector:`${h} ${n}`,rest:""};if(n[m]===",")return{selector:`${h} ${n.substring(0,m)}`,rest:n.substring(m+1)};let y=!0,k=!1;m=n.search(/\S/);let T=0;e:for(;m<n.length;++m){let z=n[m];switch(z){case"[":{let W=f.exec(n.substring(m));m+=(W?W[0].length:1)-1;continue}case"(":++T;continue;case":":if(y)if(o.test(n.substring(m))){if(T)return null}else continue;else continue;n=n.substring(0,m)+h+n.substring(m+6),m+=h.length,k=!0,--m;continue;case")":T&&--T;continue}if(!T)switch(z){case",":break e;case" ":case">":case"~":case"+":if(!y)continue;y=!1}}return{selector:(k?"":`${h} `)+n.substring(0,m),rest:n.substring(m+1)}}function r(n,h){let m=[];for(;n;){let y=l(n,h);if(y===null)return":not(*)";m.push(y.selector),n=y.rest}return m.join(", ")}function a(n,h){if(n instanceof CSSMediaRule){let m=n.cssRules.length;for(let y=0;y<m;++y)a(n.cssRules[y],h);return}if(!(n instanceof CSSStyleRule)){console.log("unknown rule in css: ",n);return}n.selectorText=r(n.selectorText,h)}let d=Q(c),p=`skruv-css-scope-${d}`,w=`.${p}`;if(M.has(d))return p;let u;if(!(globalThis!=null&&globalThis.CSSOM)&&!((s=globalThis.document)!=null&&s.implementation))throw new Error("No css parser available. Either add CSSOM to globalThis or run in browser.");if(globalThis!=null&&globalThis.CSSOM)u=CSSOM.parse(c);else{let n=globalThis.document.implementation.createHTMLDocument(""),h=n.createElement("style");h.innerText=c,n.body.append(h),u=h.sheet,n.body.removeChild(h)}Array.from((u==null?void 0:u.cssRules)||[]).forEach(n=>a(n,w));let A=Array.from((u==null?void 0:u.cssRules)||[]).map(n=>n.cssText||"").join("");return M.set(d,A),L(),p};async function*K(){for(yield Array.from(M.values()).join("");;)await H,yield Array.from(M.values()).join(""),H=new Promise(e=>{L=e})}var X=(globalThis==null?void 0:globalThis.requestAnimationFrame)||(e=>setTimeout(e,0)),Z=e=>{let t=class D{constructor(){this._scheduled=!1,this._skruv_promise=new Promise(i=>{this._skruv_resolve=i})}_resolve(){this._skruv_parent&&this._skruv_parent._resolve&&this._skruv_parent._resolve(),!this._scheduled&&(this._scheduled=!0,X(()=>{this._skruv_resolve(""),this._skruv_promise=new Promise(i=>{this._skruv_resolve=i}),this._scheduled=!1}))}set(i,o,l){return o==="_skruv_parent"?(this._skruv_parent=l,!0):(i[o]!==l&&(i[o]=this.recurse(o,l,i)),!0)}get(i,o,l){return o==="getGenerator"?r=>({key:[r,i],[Symbol.asyncIterator]:()=>{let a=!1;return{next:async()=>(a?await this._skruv_promise:a=!0,{done:!1,value:l[r]})}}}):o==="skruv_resolve"?()=>this._resolve():o==="toJSON"?i.constructor===Object?Object.getOwnPropertyNames(i).reduce((r,a)=>{var d;return r[a]=((d=i[a])==null?void 0:d.toJSON)||i[a],r},{}):i.constructor===Array?i.map(r=>(r==null?void 0:r.toJSON)||r):i:o===Symbol.asyncIterator?()=>{let r=!1;return{next:async()=>(r?await this._skruv_promise:r=!0,{done:!1,value:l})}}:i[o]}deleteProperty(i,o){let l=delete i[o];return this._resolve(),l}recurse(i,o,l){var r;if(o&&o.constructor)if(o.constructor===Object&&((r=l==null?void 0:l[i])==null?void 0:r.constructor)===Object){for(let a of Object.getOwnPropertyNames(o))l[i][a]!==o[a]&&(l[i][a]=o[a]);for(let a of Object.getOwnPropertyNames(l[i]).filter(d=>!Object.getOwnPropertyNames(o).includes(d)))delete l[i][a],this._resolve();return l[i]}else if(o.constructor===Object){let a=new D;o=Object.keys(o).reduce((d,p)=>(d[p]=this.recurse(`${i}.${p}`,o[p]),typeof d[p]=="object"&&d[p]!==null&&(d[p]._skruv_parent=a),d),{}),o=new Proxy(o,a),o._skruv_parent=this,this._resolve()}else if(o.constructor===Array){let a=new D;o=o.map((d,p)=>{let w=this.recurse(`${i}[${p}]`,d);return typeof w=="object"&&w!==null&&(w._skruv_parent=a),w}),o=new Proxy(o,a),o._skruv_parent=this,this._resolve()}else this._resolve();else this._resolve();return o}},c=new Proxy(e.constructor===Array?[]:{},new t("root"));return Object.assign(c,e),c};var _=!0,j=new WeakMap,R=()=>{},oe=new Promise(e=>{R=()=>e(!0)}),C=new Set,q=(e,t,c,f,i)=>{var o,l;return _&&!(typeof i=="object"&&"c"in i&&((l=(o=i==null?void 0:i.c)==null?void 0:o[0])==null?void 0:l["data-skruv-finished"])===!1)&&(C.delete(e),C.size||(_=!1,setTimeout(()=>R(),0))),j.set(e,i),c[t]=i,f._r._r()},O=(e,t=null,c=null,f=null,i=!0)=>{if(typeof e=="string"||typeof e=="number"||typeof e=="boolean"||e===null)return e;if(j.has(e))return j.get(e);if(t&&c&&f){if(typeof e=="object"&&Symbol.asyncIterator in e||typeof e=="function"&&e.constructor.name==="AsyncGeneratorFunction")return _&&C.add(e),j.set(e,null),(async()=>{for await(let o of typeof e=="function"?e():e)if(!q(e,t,c,f,O(o,t,c,f,!1)))break})(),null;if(typeof e=="object"&&"then"in e&&typeof e.then=="function"||typeof e=="function"&&e.constructor.name==="AsyncFunction")return _&&C.add(e),j.set(e,null),(async()=>q(e,t,c,f,O(await(typeof e=="function"?e():e),t,c,f,!1)))(),null;if(typeof e=="function"){if(typeof t=="string"&&(t[0]==="o"&&t[1]==="n"||t[0]==="_"))return e;let o=O(e(),t,c,f,!1);return j.set(e,o),o}}if(typeof e=="object"){let o={_r:{_r:()=>((_&&!C.size||!_)&&(_=!1,setTimeout(()=>R(),0)),!0)}},l=o;Array.isArray(e)&&(f==null?void 0:f._r)&&(o=[],l=f);for(let r in e){let a=O(e[r],r,o,l,!1);(a!==null||e[r]===null)&&(o[r]=a)}return(i&&_&&!C.size||!_)&&(_=!1,setTimeout(()=>R(),0)),o}return e};var B=e=>e.replace(/[A-Z]+(?![a-z])|[A-Z]/g,(t,c)=>(c?"-":"")+t.toLowerCase()),U="#fragment",g=(e,t={})=>S(e,t),S=(e,t={})=>{if(e===U&&t.children)return t.children;if(e===U)return[];let{children:c,...f}=t;return Object.keys(f).filter(i=>i!==B(i)).forEach(i=>{f[B(i)]=f[i],delete f[i]}),f["class-name"]&&(f.class=f["class-name"],delete f["class-name"]),f["html-for"]&&(f.for=f["html-for"],delete f["html-for"]),c?G(e,f||{},c):G(e,f||{})};var $=Z({todos:["Write todos"]}),Y=J`:scope{color:#f1f1f1;background:#0f0f0f}body{max-width:40ch;margin:0 auto}form{display:flex}input{flex:1}a{color:#9b9b9b}`;E(O(S("html",{lang:"en-US",class:Y,children:[S("head",{children:[g("title",{children:$.todos.getGenerator(0)}),g("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),g("style",{children:K})]}),g("body",{children:S("main",{children:[g("h1",{children:$.todos.getGenerator(0)}),S("form",{onsubmit:e=>{e.preventDefault(),$.todos.unshift(new FormData(e.target).get("todo")),e.target.reset()},children:[g("input",{name:"todo"}),g("button",{children:"New!"})]}),g("ol",{children:async function*(){for await(let e of $.todos)yield e.map((t,c)=>S("li",{children:[t," ",g("a",{href:"#",onclick:f=>{f.preventDefault(),e.splice(c,1)},children:"x"})]}))}})]})})]})));
//# sourceMappingURL=index.min.js.map
