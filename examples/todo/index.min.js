var E=Symbol.for("skruvDom"),p="data-skruv-key",w=new WeakMap,z=new WeakMap,W=new WeakMap,C={},T=(e,t=globalThis.document.documentElement,c=t.parentNode,f=!1,n=!1)=>{if(typeof e=="boolean"){t&&c.removeChild(t);return}let o=typeof e=="string"||typeof e=="number";if(n||!t||o&&t?.nodeName!=="#text"||!o&&t?.nodeName.toLowerCase()!==e.t.toLowerCase()){let s=t;if(o?t=document.createTextNode(e):f||e.t==="svg"?(f=!0,t=(C[e.t]||(C[e.t]=document.createElementNS("http://www.w3.org/2000/svg",e.t))).cloneNode(!1)):t=(C[e.t]||(C[e.t]=document.createElement(e.t))).cloneNode(!1),s?c.replaceChild(t,s):c.appendChild(t),o)return;e.c[0]?.oncreate&&e?.c[0]?.oncreate(t)}if(o){t.data!=e&&(t.data=e);return}e._r&&(e._r._r=()=>!t||!c.contains(t)?!1:(T(e,t,c,f),!0));let r=e.c.flat(1/0),i={};if(r[0]?.constructor===Object&&r[0]?.s!==E){i=r[0],r=r.slice(1);for(let s in i)if(!(s===p||s[0]==="_"))if(s[0]==="o"&&s[1]==="n"){let a=W.get(t);a||(a={},W.set(t,a));let m=s.slice(2);!a[s]||""+a[s]!=""+i[s]?(a[s]&&t.removeEventListener(m,a[s]),t.addEventListener(m,i[s]),a[s]=i[s]):i[s]||t.removeEventListener(m,a[s])}else i[s]!==t.getAttribute(s)&&((s==="checked"||s==="selected"||s==="value"||typeof i[s]=="object")&&(t[s]=i[s]),i[s]?t.setAttribute(s,""+i[s]):t.removeAttribute(s))}if(!r.length&&t.childNodes.length){if(i["data-skruv-wait-for-not-empty"])return;t.replaceChildren();return}if(t.childNodes.length>r.length)for(let s=r.length;s<t.childNodes.length;s++)t.removeChild(t.childNodes[s]);for(let s=0;s<r.length;s++){let a=!1,m;if(r[s].constructor===Object)if(m=w.get(r[s].c[0]?.[p]),m){if(m!==t.childNodes[s]&&(m===t.childNodes[s+1]?t.removeChild(t.childNodes[s]):w.get(r[s+1]?.c?.[0]?.[p])===t.childNodes[s]?t.insertBefore(m,t.childNodes[s]):t.childNodes[s]?t.replaceChild(m,t.childNodes[s]):t.appendChild(m)),a=r[s].c[0][p]!==z.get(t.childNodes[s]),!a){let M=w.get(t.childNodes[s]),_=!0;for(let k in r[s].c[0][p])r[s].c[0][p][k]!==M[k]&&(_=!1);if(_)continue}}else a=w.has(t.childNodes[s]);T(r[s],t.childNodes[s]||!1,t,f,a)}i[p]&&(w.set(i[p],t),z.set(t,i[p]),w.set(t,{...i[p]}))},Y=new Proxy({},{get:(e,t)=>(...c)=>({s:E,t,c})}),R=(e,...t)=>({s:E,t:e,c:t});var F=()=>{},I=new Promise(e=>{F=e}),A=new Map,B=e=>{let t=0;if(e.length===0)return t.toString();for(let c=0;c<e.length;c++)t=(t<<5)-t+e.charCodeAt(c),t|=0;return t.toString()},V=(e,...t)=>{let c=e.reduce((l,d,h)=>(l.push(d),l.push(t?.[h]?.toString()||""),l),[]).join(""),f=/^\[.*?(?:(["'])(?:.|\\\1)*\1.*)*\]/,n=/([([,]|:scope\b)/,o=/^:scope\b/;function r(l,d){let h=l.search(n);if(h===-1)return{selector:`${d} ${l}`,rest:""};if(l[h]===",")return{selector:`${d} ${l.substring(0,h)}`,rest:l.substring(h+1)};let y=!0,G=!1;h=l.search(/\S/);let O=0;e:for(;h<l.length;++h){let L=l[h];switch(L){case"[":{let D=f.exec(l.substring(h));h+=(D?D[0].length:1)-1;continue}case"(":++O;continue;case":":if(y)if(o.test(l.substring(h))){if(O)return null}else continue;else continue;l=l.substring(0,h)+d+l.substring(h+6),h+=d.length,G=!0,--h;continue;case")":O&&--O;continue}if(!O)switch(L){case",":break e;case" ":case">":case"~":case"+":if(!y)continue;y=!1}}return{selector:(G?"":`${d} `)+l.substring(0,h),rest:l.substring(h+1)}}function i(l,d){let h=[];for(;l;){let y=r(l,d);if(y===null)return":not(*)";h.push(y.selector),l=y.rest}return h.join(", ")}function s(l,d){if(l instanceof CSSMediaRule){let h=l.cssRules.length;for(let y=0;y<h;++y)s(l.cssRules[y],d);return}l instanceof CSSStyleRule&&(l.selectorText=i(l.selectorText,d))}let a=B(c),m=`skruv-css-scope-${a}`,M=`.${m}`;if(A.has(a))return m;let _;if(!globalThis?.CSSOM&&!globalThis.document?.implementation)throw new Error("No css parser available. Either add CSSOM to globalThis or run in browser.");if(globalThis?.CSSOM)_=CSSOM.parse(c);else{let l=globalThis.document.implementation.createHTMLDocument(""),d=l.createElement("style");d.innerText=c,l.body.append(d),_=d.sheet,l.body.removeChild(d)}Array.from(_?.cssRules||[]).forEach(l=>s(l,M));let k=Array.from(_?.cssRules||[]).map(l=>l.cssText||"").join("");return A.set(a,k),F(),m};async function*H(){for(yield Array.from(A.values()).join("");;)await I,yield Array.from(A.values()).join(""),I=new Promise(e=>{F=e})}var U=globalThis?.requestAnimationFrame||(e=>setTimeout(e,0)),J=e=>{let t=class{constructor(n){this.name=n,this._scheduled=!1,this._skruv_promise=new Promise(o=>{this._skruv_resolve=o})}_resolve(){this._skruv_parent&&this._skruv_parent._resolve&&this._skruv_parent._resolve(),!this._scheduled&&(this._scheduled=!0,U(()=>{this._skruv_resolve(),this._skruv_promise=new Promise(n=>{this._skruv_resolve=n}),this._scheduled=!1}))}set(n,o,r){return o==="_skruv_parent"?(this._skruv_parent=r,!0):(n[o]!==r&&(n[o]=this.recurse(o,r,n)),!0)}get(n,o,r){return o==="getGenerator"?i=>({key:[i,n],[Symbol.asyncIterator]:()=>{let s=!1;return{next:async()=>(s?await this._skruv_promise:s=!0,{done:!1,value:r[i]})}}}):o==="skruv_resolve"?()=>this._resolve():o==="toJSON"?n.constructor===Object?Object.getOwnPropertyNames(n).reduce((i,s)=>(i[s]=n[s]?.toJSON||n[s],i),{}):n.constructor===Array?n.map(i=>i?.toJSON||i):n:o===Symbol.asyncIterator?()=>{let i=!1;return{next:async()=>(i?await this._skruv_promise:i=!0,{done:!1,value:r})}}:n[o]}deleteProperty(n,o){let r=delete n[o];return this._resolve(),r}recurse(n,o,r){if(o&&o.constructor)if(o.constructor===Object&&r?.[n]?.constructor===Object){for(let i of Object.getOwnPropertyNames(o))r[n][i]!==o[i]&&(r[n][i]=o[i]);for(let i of Object.getOwnPropertyNames(r[n]).filter(s=>!Object.getOwnPropertyNames(o).includes(s)))delete r[n][i],this._resolve();return r[n]}else if(o.constructor===Object){let i=new this.constructor(`${this.name}.${n}`);o=Object.keys(o).reduce((s,a)=>(s[a]=this.recurse(`${n}.${a}`,o[a]),typeof s[a]=="object"&&s[a]!==null&&(s[a]._skruv_parent=i),s),{}),o=new Proxy(o,i),o._skruv_parent=this,this._resolve()}else if(o.constructor===Array){let i=new this.constructor(`${this.name}.${n}`);o=o.map((s,a)=>{let m=this.recurse(`${n}[${a}]`,s);return typeof m=="object"&&m!==null&&(m._skruv_parent=i),m}),o=new Proxy(o,i),o._skruv_parent=this,this._resolve()}else this._resolve();else this._resolve();return o}},c=new Proxy(e.constructor===Array?[]:{},new t("root"));return Object.assign(c,e),c};var u=!0,S=new WeakMap,P=()=>{},se=new Promise(e=>{P=()=>e(!0)}),x=new Set,K=(e,t,c,f,n)=>(u&&!(typeof n=="object"&&"a"in n&&n?.a?.["data-skruv-finished"]===!1)&&(x.delete(e),x.size||(u=!1,setTimeout(()=>P(),0))),S.set(e,n),c[t]=n,f._r._r()),j=(e,t,c,f,n=!0)=>{if(typeof e=="string"||typeof e=="number"||typeof e=="boolean"||e===null)return e;if(S.has(e))return S.get(e);if(typeof e=="object"&&Symbol.asyncIterator in e||typeof e=="function"&&e.constructor.name==="AsyncGeneratorFunction")return u&&x.add(e),S.set(e,null),(async()=>{for await(let o of typeof e=="function"?e():e)if(!K(e,t,c,f,j(o,t,c,f,!1)))break})(),null;if(typeof e=="object"&&"then"in e&&typeof e.then=="function"||typeof e=="function"&&e.constructor.name==="AsyncFunction")return u&&x.add(e),S.set(e,null),(async()=>K(e,t,c,f,j(await(typeof e=="function"?e():e),t,c,f,!1)))(),null;if(typeof e=="function"){if(typeof t=="string"&&(t[0]==="o"&&t[1]==="n"||t[0]==="_"))return e;let o=j(e(),t,c,f,!1);return S.set(e,o),o}if(typeof e=="object"){let o={_r:{_r:()=>((u&&!x.size||!u)&&(u=!1,setTimeout(()=>P(),0)),!0)}},r=o;Array.isArray(e)&&(o=[],r=f),t==="a"&&(o={},r=f);for(let i in e){let s=j(e[i],i,o,r,!1);(s!==null||e[i]===null)&&(o[i]=s)}return(n&&u&&!x.size||!u)&&(u=!1,setTimeout(()=>P(),0)),o}return e};var Z=e=>e.replace(/[A-Z]+(?![a-z])|[A-Z]/g,(t,c)=>(c?"-":"")+t.toLowerCase()),q="#fragment",b=(e,t={})=>g(e,t),g=(e,t={})=>{if(e===q&&t.children)return t.children;if(e===q)return[];let{children:c,...f}=t;return Object.keys(f).filter(n=>n!==Z(n)).forEach(n=>{f[Z(n)]=f[n],delete f[n]}),f["class-name"]&&(f.class=f["class-name"],delete f["class-name"]),f["html-for"]&&(f.for=f["html-for"],delete f["html-for"]),c?R(e,f||{},c):R(e,f||{})};var $=J({todos:["Write todos"]}),Q=V`:scope{color:#f1f1f1;background:#0f0f0f}body{max-width:40ch;margin:0 auto}form{display:flex}input{flex:1}a{color:#9b9b9b}`;T(j(g("html",{lang:"en-US",class:Q,children:[g("head",{children:[b("title",{children:$.todos.getGenerator(0)}),b("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),b("style",{children:H})]}),b("body",{children:g("main",{children:[b("h1",{children:$.todos.getGenerator(0)}),g("form",{onsubmit:e=>{e.preventDefault(),$.todos.unshift(new FormData(e.target).get("todo")),e.target.reset()},children:[b("input",{name:"todo"}),b("button",{children:"New!"})]}),b("ol",{children:async function*(){for await(let e of $.todos)yield e.map((t,c)=>g("li",{children:[t," ",b("a",{href:"#",onclick:f=>{f.preventDefault(),e.splice(c,1)},children:"x"})]}))}})]})})]})));
//# sourceMappingURL=index.min.js.map
