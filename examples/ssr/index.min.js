var E="http://www.w3.org/1999/xhtml",g=new WeakMap,$=new WeakMap,K=new WeakMap,D={},w=(t,e=globalThis.document.documentElement,c=e.parentNode,a=E,i=!1)=>{if(!c)throw new Error("No parent to render to");if(typeof t=="boolean"){e&&c.removeChild(e);return}if(!globalThis?.isSkruvSSR&&t?.t?.toLowerCase()==="skruvtext"&&t?.c?.[0]){t.r=()=>!e||!c.contains(e)?!1:(w(t,e,c,a),!0),w(t?.c?.[0],e);return}let o=typeof t=="string"||typeof t=="number";if(i||!e||o&&e.nodeName!=="#text"||!o&&e.nodeName.toLowerCase()!==t.t.toLowerCase()){let s=e;if(o?e=document.createTextNode(""+t):(t.t==="svg"&&(a="http://www.w3.org/2000/svg"),t.t==="math"&&(a="http://www.w3.org/1998/Math/MathML"),t.t==="feed"&&(a="http://www.w3.org/2005/Atom"),(t.t==="urlset"||t.t==="sitemapindex")&&(a="https://www.sitemaps.org/schemas/sitemap/0.9"),e=(D[t.t]||(D[t.t]=document.createElementNS(a,t.t))).cloneNode(!1)),s?c.replaceChild(e,s):c.appendChild(e),o)return}if(o){e.textContent!=t&&(e.textContent=""+t);return}t.r&&(t.r=()=>!e||!c.contains(e)?!1:(w(t,e,c,a),!0)),t.t==="foreignObject"&&(a=E);let r=t.c.flat(1/0);globalThis?.isSkruvSSR||(r=r.filter(s=>!s?.t?.startsWith("skruv")));let n={};if(r[0]?.constructor===Object&&!r[0]?.isSkruvDom){n=r[0],r=r.slice(1);let s=K.get(e);s||(s={},K.set(e,s));for(let[f,h]of Object.entries(n))if(""+s[f]!=""+h){if(f==="skruvAfterCreate"){setTimeout(()=>h(e),0),s[f]=h;continue}if(!f.startsWith("skruv")){if(f[0]==="o"&&f[1]==="n"){let d=f.slice(2);s[f]?h||e.removeEventListener(d,h):(s[f]&&e.removeEventListener(d,h),e.addEventListener(d,h)),s[f]=h;continue}(f==="checked"||f==="selected"||f==="value"||e.nodeName.includes("-"))&&(e[f]=h),h!==void 0?e.setAttribute(f,""+h):e.removeAttribute(f),s[f]=h}}}for(let s of e.getAttributeNames().filter(f=>!Object.keys(n).includes(f)))e.removeAttribute(s);if(!r.length&&e.childNodes.length){if(n.skruvWaitForNotEmpty)return;e.replaceChildren();return}if(e.childNodes.length>r.length)for(let s=e.childNodes.length-1;s>=r.length;s--)e.removeChild(e.childNodes[s]);for(let s=0;s<r.length;s++){let f=!1,h;if(r[s]?.c)if(h=g.get(r[s].c[0]?.skruvKey),h){if(h!==e.childNodes[s]&&(h===e.childNodes[s+1]?e.removeChild(e.childNodes[s]):e.childNodes[s]&&g.get(r[s+1]?.c?.[0]?.skruvKey)===e.childNodes[s]?e.insertBefore(h,e.childNodes[s]):e.childNodes[s]?e.replaceChild(h,e.childNodes[s]):e.appendChild(h)),f=r[s].c[0].skruvKey!==$.get(e.childNodes[s]),!f){let d=g.get(e.childNodes[s]);if(d){let p=!0;for(let j in r[s].c[0].skruvKey)r[s].c[0].skruvKey[j]!==d[j]&&(p=!1);if(p)continue}}}else f=g.has(e.childNodes[s]);w(r[s],e.childNodes[s]||!1,e,a,f)}n.skruvKey&&(g.set(n.skruvKey,e),$.set(e,n.skruvKey),g.set(e,{...n.skruvKey}))},W=new Proxy({},{get:(t,e)=>(...c)=>({isSkruvDom:!0,t:e,c})});var T=()=>{},F=new Promise(t=>{T=t}),v=new Map,B=t=>{let e=0;if(t.length===0)return e.toString();for(let c=0;c<t.length;c++)e=(e<<5)-e+t.charCodeAt(c),e|=0;return e.toString()},L=(t,...e)=>{let c=t.reduce((l,u,m)=>(l.push(u),l.push(e?.[m]?.toString()||""),l),[]).join(""),a=/^\[.*?(?:(["'])(?:.|\\\1)*\1.*)*\]/,i=/([([,]|:scope\b)/,o=/^:scope\b/;function r(l,u){let m=l.search(i);if(m===-1)return{selector:`${u} ${l}`,rest:""};if(l[m]===",")return{selector:`${u} ${l.substring(0,m)}`,rest:l.substring(m+1)};let y=!0,P=!1;m=l.search(/\S/);let x=0;t:for(;m<l.length;++m){let R=l[m];switch(R){case"[":{let M=a.exec(l.substring(m));m+=(M?M[0].length:1)-1;continue}case"(":++x;continue;case":":if(y)if(o.test(l.substring(m))){if(x)return null}else continue;else continue;l=l.substring(0,m)+u+l.substring(m+6),m+=u.length,P=!0,--m;continue;case")":x&&--x;continue}if(!x)switch(R){case",":break t;case" ":case">":case"~":case"+":if(!y)continue;y=!1}}return{selector:(P?"":`${u} `)+l.substring(0,m),rest:l.substring(m+1)}}function n(l,u){let m=[];for(;l;){let y=r(l,u);if(y===null)return":not(*)";m.push(y.selector),l=y.rest}return m.join(", ")}function s(l,u){if(l instanceof CSSMediaRule){let m=l.cssRules.length;for(let y=0;y<m;++y)s(l.cssRules[y],u);return}l instanceof CSSStyleRule&&(l.selectorText=n(l.selectorText,u))}let f=B(c),h=`skruv-css-scope-${f}`,d=`.${h}`;if(v.has(f))return h;let p;if(!globalThis?.CSSOM&&!globalThis.document?.implementation)throw new Error("No css parser available. Either add CSSOM to globalThis or run in browser.");if(globalThis?.CSSOM)p=CSSOM.parse(c);else{let l=globalThis.document.implementation.createHTMLDocument(""),u=l.createElementNS("http://www.w3.org/1999/xhtml","style");u.innerText=c,l.body.append(u),p=u.sheet,l.body.removeChild(u)}Array.from(p?.cssRules||[]).forEach(l=>s(l,d));let j=Array.from(p?.cssRules||[]).map(l=>l.cssText||"").join("");return v.set(f,j),T(),h};async function*G(){for(yield Array.from(v.values()).join("");;)await F,yield Array.from(v.values()).join(""),F=new Promise(t=>{T=t})}var z=t=>{let e=class A{constructor(){this._skruv_promise=new Promise(i=>{this._skruv_resolve=i})}_resolve(){this._skruv_parent&&this._skruv_parent._resolve&&this._skruv_parent._resolve(),this._skruv_resolve(""),this._skruv_promise=new Promise(i=>{this._skruv_resolve=i})}set(i,o,r){return o==="_skruv_parent"?(this._skruv_parent=r,!0):(i[o]!==r&&(i[o]=this.recurse(o,r,i)),!0)}get(i,o,r){return o==="getGenerator"?n=>({key:[n,i],[Symbol.asyncIterator]:()=>{let s=!1;return{next:async()=>(s?await this._skruv_promise:s=!0,{done:!1,value:r[n]})}}}):o==="toJSON"?i.constructor===Object?Object.getOwnPropertyNames(i).reduce((n,s)=>(n[s]=i[s]?.toJSON||i[s],n),{}):i.constructor===Array?i.map(n=>n?.toJSON||n):i:o===Symbol.asyncIterator?()=>{let n=!1;return{next:async()=>(n?await this._skruv_promise:n=!0,{done:!1,value:r})}}:i[o]}deleteProperty(i,o){let r=delete i[o];return this._resolve(),r}recurse(i,o,r){if(o&&o.constructor)if(o.constructor===Object&&r?.[i]?.constructor===Object){for(let n of Object.getOwnPropertyNames(o))r[i][n]!==o[n]&&(r[i][n]=o[n]);for(let n of Object.getOwnPropertyNames(r[i]).filter(s=>!Object.getOwnPropertyNames(o).includes(s)))delete r[i][n],this._resolve();return r[i]}else if(o.constructor===Object){let n=new A;o=Object.keys(o).reduce((s,f)=>(s[f]=this.recurse(`${i}.${f}`,o[f]),typeof s[f]=="object"&&s[f]!==null&&(s[f]._skruv_parent=n),s),{}),o=new Proxy(o,n),o._skruv_parent=this,this._resolve()}else if(o.constructor===Array){let n=new A;o=o.map((s,f)=>{let h=this.recurse(`${i}[${f}]`,s);return typeof h=="object"&&h!==null&&(h._skruv_parent=n),h}),o=new Proxy(o,n),o._skruv_parent=this,this._resolve()}else this._resolve();else this._resolve();return o}},c=new Proxy(t.constructor===Array?[]:{},new e("root"));return Object.assign(c,t),c};var b=!0,S=new WeakMap,C=()=>{},I=new Promise(t=>{C=()=>{b=!1,C=()=>{},t("")}}),k=new Set,H=(t,e,c,a,i)=>(b&&!(typeof i=="object"&&"c"in i&&i?.c?.[0]?.skruvFinished===!1)&&(k.delete(t),k.size||C()),S.set(t,i),c[e]=i,a.r?a.r():!0),_=(t,e=null,c=null,a=null,i=!0)=>{if(typeof t=="string"||typeof t=="number"||typeof t=="boolean"||t===null)return t;if(S.has(t))return S.get(t);if(e&&c&&a){if(typeof t=="object"&&Symbol.asyncIterator in t||typeof t=="function"&&t.constructor.name==="AsyncGeneratorFunction")return b&&k.add(t),S.set(t,null),(async()=>{for await(let o of typeof t=="function"?t():t)if(!H(t,e,c,a,_(o,e,c,a,!1)))break})(),null;if(typeof t=="object"&&"then"in t&&typeof t.then=="function"||typeof t=="function"&&t.constructor.name==="AsyncFunction")return b&&k.add(t),S.set(t,null),(async()=>H(t,e,c,a,_(await(typeof t=="function"?t():t),e,c,a,!1)))(),null;if(typeof t=="function"){if(e[0]==="o"&&e[1]==="n"||e==="r"&&c?.isSkruvDom===!0||e==="skruvAfterCreate")return t;let o=_(t(),e,c,a,!1);return S.set(t,o),o}}if(typeof t=="object"){let o={},r=o;t.isSkruvDom===!0?o.r=()=>((b&&!k.size||!b)&&C(),!0):a?.r&&(r=a),Array.isArray(t)&&(o=[]);for(let n in t){let s=_(t[n],n,o,r,!1);(s!==null||t[n]===null)&&(o[n]=s)}return i&&b&&!k.size&&C(),o}return t};var{html:U,head:q,title:Q,meta:V,link:X,body:Y,main:Z,h1:N,form:tt,label:et,input:st,button:ot,ol:it,li:nt,a:rt,style:lt,script:ft,skruvText:ct,skruvComment:ht,skruvHeader:at}=W,O=z({todos:["Write todos"]}),mt=L`:scope{color:#f1f1f1;background:#0f0f0f}body{max-width:40ch;margin:0 auto}form{display:flex;align-items:end}label{flex:1}input{width:100%}a{color:#9b9b9b}`,ut=_(U({lang:"en-US",class:mt},q(Q(O.todos.getGenerator(0)),V({name:"viewport",content:"width=device-width, initial-scale=1"}),lt(G),X({rel:"icon",href:"/icon.svg",type:"image/svg+xml",sizes:"any"}),V({name:"description",content:"Skruv todo-list"})),Y(Z(N(O.todos.getGenerator(0)),tt({onsubmit:t=>{t.preventDefault();let e=new FormData(t.currentTarget).get("todo")?.toString();e&&O.todos.unshift(e),t.currentTarget.reset()}},et("What do you need to do?",st({type:"text",name:"todo"})),ot("New!")),async function*(){for await(let t of O)yield it(t.todos.map((e,c)=>nt(`${e} `,rt({href:"#",onclick:a=>{a.preventDefault(),t.todos.splice(c,1)}},"x"))))}),ct("test"),ht("test"),at({name:"x-test",value:"test"}),!!globalThis.skruvSSRScript&&ft({type:"module"},globalThis.skruvSSRScript)))),J=async()=>{await I,w(ut)};J();var xt=J;export{xt as default};
//# sourceMappingURL=index.min.js.map
