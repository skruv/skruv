var O=Symbol.for("skruvDom"),x=Symbol.for("skruvDomPrepared"),S=new WeakMap,M=new WeakMap,L=new WeakMap,W=()=>{},D=new Promise(t=>{W=()=>t()}),w=new Set,g=(globalThis==null?void 0:globalThis.SkruvWaitForAsync)||!!document.querySelector("data-skruv-ssr-rendered");var A=(t,...e)=>{var i,o,a,h,l;return{s:O,t,...typeof e[0]=="object"&&!Array.isArray(e[0])&&!(e[0]instanceof Function)&&!(e[0]instanceof Function&&((a=(o=(i=e[0])==null?void 0:i.prototype)==null?void 0:o.toString)==null?void 0:a.call(o))==="[object AsyncGenerator]")&&!((h=e[0])!=null&&h[Symbol.asyncIterator])&&((l=e[0])==null?void 0:l.s)!==O?{_a:e[0],_c:e.slice(1)}:{_a:{},_c:e},r:{r:()=>(g&&!w.size&&(g=!1,W()),!0)}}},_=(t,e,i)=>{var a,h;let o=(l,y)=>{var m;return g&&((m=y==null?void 0:y._a)==null?void 0:m["data-skruv-finished"])!==!1&&(w.delete(l),y&&((y==null?void 0:y.s)===O?T(y):_(y,e,i))),S.set(l,y),e.r.r()};if(S.has(t))return S.get(t);if(typeof t=="object"&&(t==null?void 0:t[Symbol.asyncIterator])){let l=t;return g&&w.add(l),S.set(l,null),(async()=>{for await(let y of l)if(!o(t,y))break})(),!1}else{if(t instanceof Function&&((h=(a=t==null?void 0:t.prototype)==null?void 0:a.toString)==null?void 0:h.call(a))==="[object AsyncGenerator]")return g&&w.add(t),S.set(t,null),(async()=>{for await(let l of t())if(!o(t,l))break})(),!1;if(typeof t=="object"&&t!==null&&(t==null?void 0:t.then)instanceof Function){let l=t;return g&&w.add(t),S.set(l,null),(async()=>o(l,await l))(),!1}else{if(typeof t=="function"&&t.constructor.name==="AsyncFunction")return g&&w.add(t),S.set(t,null),(async()=>o(t,await t()))(),!1;if(typeof t=="function")return i?t():t;if(typeof t=="string"||typeof t=="number")return i?A("#text",{data:t.toString()}):t.toString();if(typeof t=="boolean")return t}}throw new Error("Unkown type in syncify: "+JSON.stringify(t))},J=(t,e)=>{let i=t.flat(1/0).map(o=>(o==null?void 0:o.s)===O?T(o):_(o,e,!0)).flat(1/0).filter(o=>o!==null&&typeof o!="boolean"&&typeof o!="undefined");return i.find(o=>(o==null?void 0:o.p)!==x)!==void 0?J(i,e):i},T=t=>{let e=Object.fromEntries(Object.entries(t._a).filter(i=>i[1]!==null&&typeof i[1]!="undefined").map(([i,o])=>i==="data-skruv-key"?[i,o]:[i,_(o,t,!1)]).filter(i=>i[1]!==null&&typeof i[1]!="undefined"));return{p:x,...t,a:e,c:J(t._c,t)}},F=(t,e,i,o)=>{var C;if(t.p!==x)throw new Error("unkown type in render: "+JSON.stringify(t));for(let n of t.c)if(n.p!==x)throw new Error("unkown type in render: "+JSON.stringify(n));if(!i||e&&!i.contains(e))return!1;let a=e.ownerDocument,h=a.documentElement;for(let n of e.getAttributeNames().filter(r=>!Object.keys(t.a).includes(r)))e.removeAttribute(n);for(let[n,r]of Object.entries(t.a))if(n!=="data-skruv-key"){if(n.slice(0,2)==="on"){let d=M.get(e),s=d==null?void 0:d[n],c=n.slice(2);if(d||(d={},M.set(e,d)),r instanceof Function){s&&s.toString()!==r.toString()&&(e.removeEventListener(c,s),d[n]=null),s||(d[n]=r,e.addEventListener(c,r));continue}s&&!r&&(e.removeEventListener(c,s),d[n]=null)}if(r===null||r===!1){e.getAttribute(n)&&e.removeAttribute(n);continue}e.setAttribute(n,r.toString()),n==="value"&&(typeof r=="number"||typeof r=="string")&&e instanceof HTMLInputElement&&(e[n]=r.toString()),(typeof r=="boolean"&&(e instanceof HTMLInputElement&&n==="checked"||e instanceof HTMLOptionElement&&n==="selected")||typeof r=="object")&&(e[n]=r)}if(t.r.r=()=>F(T(t),e,i,o),t.a["data-skruv-opaque"])return!0;let l=Array.from(e.childNodes),y=t.c,m=[],u=(n,r)=>n.nodeName.toLowerCase()===r.t&&!m.includes(n);for(let n=0;n<y.length;n++){let r=y[n],d=r.a["data-skruv-key"]?L.get(r.a["data-skruv-key"]):l.find(s=>u(s,r));d?m[n]=d:m[n]=null}let k=l.filter(n=>!m.includes(n));if(t.c.length||!t.a["data-skruv-wait-for-not-empty"])for(let n of k.filter(r=>!!r))e.removeChild(n),setTimeout(()=>{var r;!(h!=null&&h.contains(n))&&((r=M.get(n))==null?void 0:r.onremove)&&n.dispatchEvent(new CustomEvent("remove"))},1);for(let n=0;n<m.length;n++){let r=t.c[n],d=!1;if(m[n]){if(m[n]!==e.childNodes[n]){let c=m[n];c&&(n===0?e.prepend(c):e.childNodes[n-1].after(c))}}else{let c;t.t==="#comment"?c=a.createComment(""):r.t==="#text"?c=a.createTextNode(""):r.p===x&&(o||r.t==="svg")?c=a.createElementNS("http://www.w3.org/2000/svg",r.t):c=a.createElement(r.t),d=!0,e.childNodes[n]?e.replaceChild(c,e.childNodes[n]):n===0?e.prepend(c):e.childNodes[n-1].after(c)}let s=e.childNodes[n];if(s instanceof Text||s instanceof Comment){s.data!==r.a.data&&(s.data=r.a.data.toString());continue}if(!(s instanceof HTMLElement||s instanceof SVGElement))throw new Error("Child node of unknown type: "+JSON.stringify({childNode:s,child:r}));r.a["data-skruv-key"]&&!L.has(r.a["data-skruv-key"])&&L.set(r.a["data-skruv-key"],s),F(r,s,e,o||t.t==="svg"),d&&((C=M.get(s))==null?void 0:C.oncreate)&&s.dispatchEvent(new CustomEvent("create"))}return!0},V=async(t,e=document.documentElement,i=e==null?void 0:e.parentNode,o=!1)=>{if(!i)throw new Error("Skruv: No parent to render to");if(!(i instanceof HTMLElement||i instanceof SVGElement||i instanceof Document||i instanceof Window))throw new Error("Skruv: Parent of wrong type");g&&(T(t).r.r(),await D),F(T(t),e,i,o)},Z={},v=new Proxy(Z,{get:(t,e)=>(...i)=>A(e,...i)});var P=()=>{},z=new Promise(t=>{P=t}),R=new Map,K=t=>{let e=0;if(t.length===0)return e.toString();for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e.toString()},G=(t,...e)=>{var d;let i=t.reduce((s,c,f)=>{var p;return s.push(c),s.push(((p=e==null?void 0:e[f])==null?void 0:p.toString())||""),s},[]).join(""),o=/^\[.*?(?:(["'])(?:.|\\\1)*\1.*)*\]/,a=/([([,]|:scope\b)/,h=/^:scope\b/;function l(s,c){let f=s.search(a);if(f===-1)return{selector:`${c} ${s}`,rest:""};if(s[f]===",")return{selector:`${c} ${s.substring(0,f)}`,rest:s.substring(f+1)};let p=!0,$=!1;f=s.search(/\S/);let E=0;t:for(;f<s.length;++f){let H=s[f];switch(H){case"[":{let I=o.exec(s.substring(f));f+=(I?I[0].length:1)-1;continue}case"(":++E;continue;case":":if(p)if(h.test(s.substring(f))){if(E)return null}else continue;else continue;s=s.substring(0,f)+c+s.substring(f+6),f+=c.length,$=!0,--f;continue;case")":E&&--E;continue}if(!E)switch(H){case",":break t;case" ":case">":case"~":case"+":if(!p)continue;p=!1}}return{selector:($?"":`${c} `)+s.substring(0,f),rest:s.substring(f+1)}}function y(s,c){let f=[];for(;s;){let p=l(s,c);if(p===null)return":not(*)";f.push(p.selector),s=p.rest}return f.join(", ")}function m(s,c){if(s instanceof CSSMediaRule){let f=s.cssRules.length;for(let p=0;p<f;++p)m(s.cssRules[p],c);return}s instanceof CSSStyleRule&&(s.selectorText=y(s.selectorText,c))}let u=K(i),k=`skruv-css-scope-${u}`,C=`.${k}`;if(R.has(u))return k;let n;if(!(globalThis!=null&&globalThis.CSSOM)&&!((d=globalThis.document)!=null&&d.implementation))throw new Error("No css parser available. Either add CSSOM to globalThis or run in browser.");if(globalThis!=null&&globalThis.CSSOM)n=CSSOM.parse(i);else{let s=globalThis.document.implementation.createHTMLDocument(""),c=s.createElement("style");c.innerText=i,s.body.append(c),n=c.sheet,s.body.removeChild(c)}Array.from((n==null?void 0:n.cssRules)||[]).forEach(s=>m(s,C));let r=Array.from((n==null?void 0:n.cssRules)||[]).map(s=>s.cssText||"").join("");return R.set(u,r),P(),k};async function*U(){for(yield Array.from(R.values()).join("");;)await z,yield Array.from(R.values()).join(""),z=new Promise(t=>{P=t})}var q=t=>t.replace(/[A-Z]+(?![a-z])|[A-Z]/g,(e,i)=>(i?"-":"")+e.toLowerCase()),B="#fragment",b=(t,e={})=>j(t,e),j=(t,e={})=>{if(t===B&&e.children)return e.children;if(t===B)return[];let{children:i,...o}=e;return Object.keys(o).filter(a=>a!==q(a)).forEach(a=>{o[q(a)]=o[a],delete o[a]}),o["class-name"]&&(o.class=o["class-name"],delete o["class-name"]),o["html-for"]&&(o.for=o["html-for"],delete o["html-for"]),i?A(t,o||{},i):A(t,o||{})};var Q=G`:root{font-family:-apple-system,BlinkMacSystemFont,avenir next,avenir,segoe ui,helvetica neue,helvetica,Cantarell,Ubuntu,roboto,noto,arial,sans-serif}`,X=G`:scope{border:1px solid}p{color:#00f}`;V(j("html",{lang:"en-US",class:Q,children:[j("head",{children:[b("title",{children:"jsx"}),b("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),b("style",{children:U})]}),j("body",{children:[b("div",{class:X,children:b("p",{children:"blue text"})}),b("div",{children:b("p",{children:"default text"})})]})]}));
//# sourceMappingURL=index.min.js.map
