var K="http://www.w3.org/1999/xhtml",k=new WeakMap,D=new WeakMap,W=new WeakMap,F={},_=(t,e=globalThis.document.documentElement,r=e.parentNode,a=K,n=!1)=>{var h,u,p,b,w,P,v,l,y,m;if(!r)throw new Error("No parent to render to");if(typeof t=="boolean"){e&&r.removeChild(e);return}if(!(globalThis!=null&&globalThis.isSkruvSSR)&&((h=t==null?void 0:t.t)==null?void 0:h.toLowerCase())==="skruvtext"&&((u=t==null?void 0:t.c)==null?void 0:u[0])){t.r=()=>!e||!r.contains(e)?!1:(_(t,e,r,a),!0),_((p=t==null?void 0:t.c)==null?void 0:p[0],e);return}let o=typeof t=="string"||typeof t=="number";if(n||!e||o&&e.nodeName!=="#text"||!o&&e.nodeName.toLowerCase()!==t.t.toLowerCase()){let s=e;if(o?e=document.createTextNode(""+t):(t.t==="svg"&&(a="http://www.w3.org/2000/svg"),t.t==="math"&&(a="http://www.w3.org/1998/Math/MathML"),t.t==="feed"&&(a="http://www.w3.org/2005/Atom"),(t.t==="urlset"||t.t==="sitemapindex")&&(a="https://www.sitemaps.org/schemas/sitemap/0.9"),e=(F[t.t]||(F[t.t]=document.createElementNS(a,t.t))).cloneNode(!1)),s?r.replaceChild(e,s):r.appendChild(e),o)return}if(o){e.textContent!=t&&(e.textContent=""+t);return}t.r&&(t.r=()=>!e||!r.contains(e)?!1:(_(t,e,r,a),!0)),t.t==="foreignObject"&&(a=K);let i=t.c.flat(1/0);globalThis!=null&&globalThis.isSkruvSSR||(i=i.filter(s=>{var c;return!((c=s==null?void 0:s.t)!=null&&c.startsWith("skruv"))}));let f={};if(((b=i[0])==null?void 0:b.constructor)===Object&&!((w=i[0])!=null&&w.isSkruvDom)){f=i[0],i=i.slice(1);let s=W.get(e);s||(s={},W.set(e,s));for(let[c,d]of Object.entries(f))if(""+s[c]!=""+d){if(c==="skruvAfterCreate"){setTimeout(()=>d(e),0),s[c]=d;continue}if(!c.startsWith("skruv")){if(c[0]==="o"&&c[1]==="n"){let g=c.slice(2);s[c]?d||e.removeEventListener(g,d):(s[c]&&e.removeEventListener(g,d),e.addEventListener(g,d)),s[c]=d;continue}(c==="checked"||c==="selected"||c==="value"||e.nodeName.includes("-"))&&(e[c]=d),d!==void 0?e.setAttribute(c,""+d):e.removeAttribute(c),s[c]=d}}}for(let s of e.getAttributeNames().filter(c=>!Object.keys(f).includes(c)))e.removeAttribute(s);if(!i.length&&e.childNodes.length){if(f.skruvWaitForNotEmpty)return;e.replaceChildren();return}if(e.childNodes.length>i.length)for(let s=e.childNodes.length-1;s>=i.length;s--)e.removeChild(e.childNodes[s]);for(let s=0;s<i.length;s++){let c=!1,d;if((P=i[s])!=null&&P.c)if(d=k.get((v=i[s].c[0])==null?void 0:v.skruvKey),d){if(d!==e.childNodes[s]&&(d===e.childNodes[s+1]?e.removeChild(e.childNodes[s]):e.childNodes[s]&&k.get((m=(y=(l=i[s+1])==null?void 0:l.c)==null?void 0:y[0])==null?void 0:m.skruvKey)===e.childNodes[s]?e.insertBefore(d,e.childNodes[s]):e.childNodes[s]?e.replaceChild(d,e.childNodes[s]):e.appendChild(d)),c=i[s].c[0].skruvKey!==D.get(e.childNodes[s]),!c){let g=k.get(e.childNodes[s]);if(g){let O=!0;for(let T in i[s].c[0].skruvKey)i[s].c[0].skruvKey[T]!==g[T]&&(O=!1);if(O)continue}}}else c=k.has(e.childNodes[s]);_(i[s],e.childNodes[s]||!1,e,a,c)}f.skruvKey&&(k.set(f.skruvKey,e),D.set(e,f.skruvKey),k.set(e,{...f.skruvKey}))},L=new Proxy({},{get:(t,e)=>(...r)=>({isSkruvDom:!0,t:e,c:r})});var E=()=>{},G=new Promise(t=>{E=t}),R=new Map,q=t=>{let e=0;if(t.length===0)return e.toString();for(let r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r),e|=0;return e.toString()},z=(t,...e)=>{var v;let r=t.reduce((l,y,m)=>{var s;return l.push(y),l.push(((s=e==null?void 0:e[m])==null?void 0:s.toString())||""),l},[]).join(""),a=/^\[.*?(?:(["'])(?:.|\\\1)*\1.*)*\]/,n=/([([,]|:scope\b)/,o=/^:scope\b/;function i(l,y){let m=l.search(n);if(m===-1)return{selector:`${y} ${l}`,rest:""};if(l[m]===",")return{selector:`${y} ${l.substring(0,m)}`,rest:l.substring(m+1)};let s=!0,c=!1;m=l.search(/\S/);let d=0;t:for(;m<l.length;++m){let O=l[m];switch(O){case"[":{let T=a.exec(l.substring(m));m+=(T?T[0].length:1)-1;continue}case"(":++d;continue;case":":if(s)if(o.test(l.substring(m))){if(d)return null}else continue;else continue;l=l.substring(0,m)+y+l.substring(m+6),m+=y.length,c=!0,--m;continue;case")":d&&--d;continue}if(!d)switch(O){case",":break t;case" ":case">":case"~":case"+":if(!s)continue;s=!1}}return{selector:(c?"":`${y} `)+l.substring(0,m),rest:l.substring(m+1)}}function f(l,y){let m=[];for(;l;){let s=i(l,y);if(s===null)return":not(*)";m.push(s.selector),l=s.rest}return m.join(", ")}function h(l,y){if(l instanceof CSSMediaRule){let m=l.cssRules.length;for(let s=0;s<m;++s)h(l.cssRules[s],y);return}l instanceof CSSStyleRule&&(l.selectorText=f(l.selectorText,y))}let u=q(r),p=`skruv-css-scope-${u}`,b=`.${p}`;if(R.has(u))return p;let w;if(!(globalThis!=null&&globalThis.CSSOM)&&!((v=globalThis.document)!=null&&v.implementation))throw new Error("No css parser available. Either add CSSOM to globalThis or run in browser.");if(globalThis!=null&&globalThis.CSSOM)w=CSSOM.parse(r);else{let l=globalThis.document.implementation.createHTMLDocument(""),y=l.createElementNS("http://www.w3.org/1999/xhtml","style");y.innerText=r,l.body.append(y),w=y.sheet,l.body.removeChild(y)}Array.from((w==null?void 0:w.cssRules)||[]).forEach(l=>h(l,b));let P=Array.from((w==null?void 0:w.cssRules)||[]).map(l=>l.cssText||"").join("");return R.set(u,P),E(),p};async function*H(){for(yield Array.from(R.values()).join("");;)await G,yield Array.from(R.values()).join(""),G=new Promise(t=>{E=t})}var I=t=>{let e=class ${constructor(){this._skruv_promise=new Promise(n=>{this._skruv_resolve=n})}_resolve(){this._skruv_parent&&this._skruv_parent._resolve&&this._skruv_parent._resolve(),this._skruv_resolve(""),this._skruv_promise=new Promise(n=>{this._skruv_resolve=n})}set(n,o,i){return o==="_skruv_parent"?(this._skruv_parent=i,!0):(n[o]!==i&&(n[o]=this.recurse(o,i,n)),!0)}get(n,o,i){return o==="getGenerator"?f=>({key:[f,n],[Symbol.asyncIterator]:()=>{let h=!1;return{next:async()=>(h?await this._skruv_promise:h=!0,{done:!1,value:i[f]})}}}):o==="toJSON"?n.constructor===Object?Object.getOwnPropertyNames(n).reduce((f,h)=>{var u;return f[h]=((u=n[h])==null?void 0:u.toJSON)||n[h],f},{}):n.constructor===Array?n.map(f=>(f==null?void 0:f.toJSON)||f):n:o===Symbol.asyncIterator?()=>{let f=!1;return{next:async()=>(f?await this._skruv_promise:f=!0,{done:!1,value:i})}}:n[o]}deleteProperty(n,o){let i=delete n[o];return this._resolve(),i}recurse(n,o,i){var f;if(o&&o.constructor)if(o.constructor===Object&&((f=i==null?void 0:i[n])==null?void 0:f.constructor)===Object){for(let h of Object.getOwnPropertyNames(o))i[n][h]!==o[h]&&(i[n][h]=o[h]);for(let h of Object.getOwnPropertyNames(i[n]).filter(u=>!Object.getOwnPropertyNames(o).includes(u)))delete i[n][h],this._resolve();return i[n]}else if(o.constructor===Object){let h=new $;o=Object.keys(o).reduce((u,p)=>(u[p]=this.recurse(`${n}.${p}`,o[p]),typeof u[p]=="object"&&u[p]!==null&&(u[p]._skruv_parent=h),u),{}),o=new Proxy(o,h),o._skruv_parent=this,this._resolve()}else if(o.constructor===Array){let h=new $;o=o.map((u,p)=>{let b=this.recurse(`${n}[${p}]`,u);return typeof b=="object"&&b!==null&&(b._skruv_parent=h),b}),o=new Proxy(o,h),o._skruv_parent=this,this._resolve()}else this._resolve();else this._resolve();return o}},r=new Proxy(t.constructor===Array?[]:{},new e("root"));return Object.assign(r,t),r};var S=!0,x=new WeakMap,A=()=>{},J=new Promise(t=>{A=()=>{S=!1,A=()=>{},t("")}}),C=new Set,V=(t,e,r,a,n)=>{var o,i;return S&&!(typeof n=="object"&&"c"in n&&((i=(o=n==null?void 0:n.c)==null?void 0:o[0])==null?void 0:i.skruvFinished)===!1)&&(C.delete(t),C.size||A()),x.set(t,n),r[e]=n,a.r?a.r():!0},j=(t,e=null,r=null,a=null,n=!0)=>{if(typeof t=="string"||typeof t=="number"||typeof t=="boolean"||t===null)return t;if(x.has(t))return x.get(t);if(e&&r&&a){if(typeof t=="object"&&Symbol.asyncIterator in t||typeof t=="function"&&t.constructor.name==="AsyncGeneratorFunction")return S&&C.add(t),x.set(t,null),(async()=>{for await(let o of typeof t=="function"?t():t)if(!V(t,e,r,a,j(o,e,r,a,!1)))break})(),null;if(typeof t=="object"&&"then"in t&&typeof t.then=="function"||typeof t=="function"&&t.constructor.name==="AsyncFunction")return S&&C.add(t),x.set(t,null),(async()=>V(t,e,r,a,j(await(typeof t=="function"?t():t),e,r,a,!1)))(),null;if(typeof t=="function"){if(e[0]==="o"&&e[1]==="n"||e==="r"&&(r==null?void 0:r.isSkruvDom)===!0||e==="skruvAfterCreate")return t;let o=j(t(),e,r,a,!1);return x.set(t,o),o}}if(typeof t=="object"){let o={},i=o;t.isSkruvDom===!0?o.r=()=>((S&&!C.size||!S)&&A(),!0):a!=null&&a.r&&(i=a),Array.isArray(t)&&(o=[]);for(let f in t){let h=j(t[f],f,o,i,!1);(h!==null||t[f]===null)&&(o[f]=h)}return n&&S&&!C.size&&A(),o}return t};var{html:Q,head:X,title:Y,meta:B,link:Z,body:N,main:tt,h1:et,form:st,label:ot,input:it,button:nt,ol:lt,li:rt,a:ft,style:ct,script:ht,skruvText:at,skruvComment:mt,skruvHeader:dt}=L,M=I({todos:["Write todos"]}),yt=z`:scope{color:#f1f1f1;background:#0f0f0f}body{max-width:40ch;margin:0 auto}form{display:flex;align-items:end}label{flex:1}input{width:100%}a{color:#9b9b9b}`,ut=j(Q({lang:"en-US",class:yt},X(Y(M.todos.getGenerator(0)),B({name:"viewport",content:"width=device-width, initial-scale=1"}),ct(H),Z({rel:"icon",href:"/icon.svg",type:"image/svg+xml",sizes:"any"}),B({name:"description",content:"Skruv todo-list"})),N(tt(et(M.todos.getGenerator(0)),st({onsubmit:t=>{var r;t.preventDefault();let e=(r=new FormData(t.currentTarget).get("todo"))==null?void 0:r.toString();e&&M.todos.unshift(e),t.currentTarget.reset()}},ot("What do you need to do?",it({type:"text",name:"todo"})),nt("New!")),async function*(){for await(let t of M)yield lt(t.todos.map((e,r)=>rt(`${e} `,ft({href:"#",onclick:a=>{a.preventDefault(),t.todos.splice(r,1)}},"x"))))}),at("test"),mt("test"),dt({name:"x-test",value:"test"}),!!globalThis.skruvSSRScript&&ht({type:"module"},globalThis.skruvSSRScript)))),U=async()=>{await J,_(ut)};U();var Ct=U;export{Ct as default};
//# sourceMappingURL=index.min.js.map
